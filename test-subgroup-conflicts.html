<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test - R√®gles de Conflit des Sous-Groupes</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .rule-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 6px;
        }
        .forbidden {
            background: #fef2f2;
            border-color: #fca5a5;
        }
        .allowed {
            background: #f0fdf4;
            border-color: #86efac;
        }
        .test-case {
            display: flex;
            align-items: center;
            margin: 10px 0;
            padding: 10px;
            border-radius: 4px;
            background: rgba(255,255,255,0.7);
        }
        .course-box {
            display: inline-block;
            padding: 8px 12px;
            margin: 0 5px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 14px;
            min-width: 60px;
            text-align: center;
        }
        .td-course {
            background: #dbeafe;
            border: 2px solid #3b82f6;
            color: #1e40af;
        }
        .tp-course {
            background: #fed7aa;
            border: 2px solid #f97316;
            color: #c2410c;
        }
        .vs {
            margin: 0 15px;
            font-size: 18px;
            font-weight: bold;
        }
        .result {
            margin-left: 20px;
            padding: 5px 10px;
            border-radius: 4px;
            font-weight: bold;
        }
        .forbidden-result {
            background: #fecaca;
            color: #dc2626;
        }
        .allowed-result {
            background: #bbf7d0;
            color: #16a34a;
        }
        .rule-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        .status-icon {
            margin-right: 10px;
            font-size: 20px;
        }
        .explanation {
            background: #f8fafc;
            padding: 15px;
            border-radius: 4px;
            margin: 15px 0;
            border-left: 4px solid #64748b;
        }
        .code-logic {
            background: #1f2937;
            color: #f9fafb;
            padding: 15px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            margin: 10px 0;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéØ Test - R√®gles de Conflit des Sous-Groupes</h1>
        <p>Validation des r√®gles de conflit pour les sous-groupes TD/TP dans le syst√®me de planning.</p>

        <div class="rule-section forbidden">
            <div class="rule-title">
                <span class="status-icon">‚ùå</span>
                R√®gles INTERDITES
            </div>
            
            <div class="explanation">
                <strong>Principe 1 :</strong> Les sous-groupes avec le m√™me num√©ro ne peuvent pas √™tre en parall√®le 
                (TD11 vs TP11), car ils repr√©sentent les m√™mes √©tudiants divis√©s entre TD et TP.
                <br><br>
                <strong>Principe 2 :</strong> Les cours du m√™me sous-groupe ne peuvent pas √™tre en parall√®le 
                (TD11 vs TD11), car c'est le m√™me groupe d'√©tudiants.
            </div>

            <h4>üö´ M√™me num√©ro, types diff√©rents :</h4>
            <div class="test-case">
                <span class="course-box td-course">TD11</span>
                <span class="vs">VS</span>
                <span class="course-box tp-course">TP11</span>
                <span class="result forbidden-result">‚ùå INTERDIT</span>
            </div>

            <div class="test-case">
                <span class="course-box td-course">TD12</span>
                <span class="vs">VS</span>
                <span class="course-box tp-course">TP12</span>
                <span class="result forbidden-result">‚ùå INTERDIT</span>
            </div>

            <div class="test-case">
                <span class="course-box td-course">TD21</span>
                <span class="vs">VS</span>
                <span class="course-box tp-course">TP21</span>
                <span class="result forbidden-result">‚ùå INTERDIT</span>
            </div>

            <h4>üö´ M√™me sous-groupe exact :</h4>
            <div class="test-case">
                <span class="course-box td-course">TD11</span>
                <span class="vs">VS</span>
                <span class="course-box td-course">TD11</span>
                <span class="result forbidden-result">‚ùå INTERDIT</span>
            </div>

            <div class="test-case">
                <span class="course-box tp-course">TP11</span>
                <span class="vs">VS</span>
                <span class="course-box tp-course">TP11</span>
                <span class="result forbidden-result">‚ùå INTERDIT</span>
            </div>

            <div class="test-case">
                <span class="course-box td-course">TD12</span>
                <span class="vs">VS</span>
                <span class="course-box td-course">TD12</span>
                <span class="result forbidden-result">‚ùå INTERDIT</span>
            </div>

            <div class="test-case">
                <span class="course-box tp-course">TP22</span>
                <span class="vs">VS</span>
                <span class="course-box tp-course">TP22</span>
                <span class="result forbidden-result">‚ùå INTERDIT</span>
            </div>
        </div>

        <div class="rule-section allowed">
            <div class="rule-title">
                <span class="status-icon">‚úÖ</span>
                R√®gle AUTORIS√âE : Num√©ros de sous-groupes diff√©rents
            </div>
            
            <div class="explanation">
                <strong>Principe :</strong> Les sous-groupes avec des num√©ros diff√©rents peuvent √™tre en parall√®le, 
                car ils repr√©sentent des √©tudiants diff√©rents.
            </div>

            <div class="test-case">
                <span class="course-box td-course">TD11</span>
                <span class="vs">VS</span>
                <span class="course-box tp-course">TP12</span>
                <span class="result allowed-result">‚úÖ AUTORIS√â</span>
            </div>

            <div class="test-case">
                <span class="course-box td-course">TD12</span>
                <span class="vs">VS</span>
                <span class="course-box tp-course">TP11</span>
                <span class="result allowed-result">‚úÖ AUTORIS√â</span>
            </div>

            <div class="test-case">
                <span class="course-box td-course">TD21</span>
                <span class="vs">VS</span>
                <span class="course-box tp-course">TP22</span>
                <span class="result allowed-result">‚úÖ AUTORIS√â</span>
            </div>

            <div class="test-case">
                <span class="course-box td-course">TD22</span>
                <span class="vs">VS</span>
                <span class="course-box tp-course">TP21</span>
                <span class="result allowed-result">‚úÖ AUTORIS√â</span>
            </div>

            <div class="test-case">
                <span class="course-box td-course">TD11</span>
                <span class="vs">VS</span>
                <span class="course-box tp-course">TP21</span>
                <span class="result allowed-result">‚úÖ AUTORIS√â</span>
            </div>

            <div class="test-case">
                <span class="course-box td-course">TD12</span>
                <span class="vs">VS</span>
                <span class="course-box tp-course">TP22</span>
                <span class="result allowed-result">‚úÖ AUTORIS√â</span>
            </div>
        </div>

        <div class="rule-section">
            <div class="rule-title">
                <span class="status-icon">üîß</span>
                Impl√©mentation Technique
            </div>
            
            <div class="explanation">
                <strong>Logique ajout√©e dans la fonction checkInstantConflict :</strong>
            </div>

            <div class="code-logic">
// Interdire les sous-groupes du m√™me num√©ro d'√™tre en parall√®le
// TD11 ne peut pas √™tre avec TP11, mais TD11 peut √™tre avec TP12
// TD11 ne peut pas √™tre avec TD11, TP11 ne peut pas √™tre avec TP11
if (draggingCourse.subLabel && existingCourse.subLabel) {
  const draggingSubGroup = draggingCourse.subLabel;
  const existingSubGroup = existingCourse.subLabel;
  
  // Extraire le num√©ro de sous-groupe (ex: TD11 ‚Üí 11, TP12 ‚Üí 12)
  const draggingMatch = draggingSubGroup.match(/^(TD|TP)(\d+)$/);
  const existingMatch = existingSubGroup.match(/^(TD|TP)(\d+)$/);
  
  if (draggingMatch && existingMatch) {
    const draggingSubNumber = draggingMatch[2]; // "11", "12", etc.
    const existingSubNumber = existingMatch[2]; // "11", "12", etc.
    
    // Si m√™me num√©ro de sous-groupe ET types diff√©rents (TD vs TP)
    if (draggingSubNumber === existingSubNumber && draggingMatch[1] !== existingMatch[1]) {
      return `CONFLIT SOUS-GROUPE : ${draggingSubGroup} ne peut pas √™tre en parall√®le avec ${existingSubGroup} (m√™me num√©ro de sous-groupe)`;
    }
    
    // Si exactement le m√™me sous-groupe (TD11 avec TD11, TP11 avec TP11)
    if (draggingSubNumber === existingSubNumber && draggingMatch[1] === existingMatch[1]) {
      return `CONFLIT SOUS-GROUPE : ${draggingSubGroup} ne peut pas √™tre en parall√®le avec un autre ${existingSubGroup} (m√™me sous-groupe)`;
    }
  }
}
            </div>

            <div class="explanation">
                <strong>Points cl√©s de l'impl√©mentation :</strong>
                <ul>
                    <li>‚úÖ Utilise une regex pour extraire le type (TD/TP) et le num√©ro (11, 12, etc.)</li>
                    <li>‚úÖ Compare les num√©ros de sous-groupes ET les types</li>
                    <li>‚úÖ Interdit TD11 vs TP11 (m√™me num√©ro, types diff√©rents)</li>
                    <li>‚úÖ Interdit TD11 vs TD11 (m√™me sous-groupe exact)</li>
                    <li>‚úÖ Interdit TP11 vs TP11 (m√™me sous-groupe exact)</li>
                    <li>‚úÖ Messages d'erreur explicites pour l'utilisateur</li>
                    <li>‚úÖ Fonctionne avec tous les groupes (G1, G2, G3, G4)</li>
                </ul>
            </div>
        </div>

        <div class="rule-section">
            <div class="rule-title">
                <span class="status-icon">üìã</span>
                Exemples de Messages d'Erreur
            </div>
            
            <div class="explanation">
                Quand l'utilisateur essaie de placer des cours en conflit, il verra :
            </div>

            <div class="test-case">
                <strong>Tentative :</strong> Placer TP11 dans un cr√©neau o√π TD11 existe d√©j√†
                <br>
                <strong>Message :</strong> 
                <span style="color: #dc2626; font-weight: bold;">
                    "CONFLIT SOUS-GROUPE : TP11 ne peut pas √™tre en parall√®le avec TD11 (m√™me num√©ro de sous-groupe)"
                </span>
            </div>

            <div class="test-case">
                <strong>Tentative :</strong> Placer TD11 dans un cr√©neau o√π TD11 existe d√©j√†
                <br>
                <strong>Message :</strong> 
                <span style="color: #dc2626; font-weight: bold;">
                    "CONFLIT SOUS-GROUPE : TD11 ne peut pas √™tre en parall√®le avec un autre TD11 (m√™me sous-groupe)"
                </span>
            </div>

            <div class="test-case">
                <strong>Tentative :</strong> Placer TP22 dans un cr√©neau o√π TP22 existe d√©j√†
                <br>
                <strong>Message :</strong> 
                <span style="color: #dc2626; font-weight: bold;">
                    "CONFLIT SOUS-GROUPE : TP22 ne peut pas √™tre en parall√®le avec un autre TP22 (m√™me sous-groupe)"
                </span>
            </div>
        </div>

        <div class="rule-section">
            <div class="rule-title">
                <span class="status-icon">‚úÖ</span>
                Validation et Tests
            </div>
            
            <div class="explanation">
                <strong>Pour tester cette fonctionnalit√© :</strong>
                <ol>
                    <li>Cr√©er des cours TD11 et TP11 pour la m√™me mati√®re</li>
                    <li>Essayer de les placer dans le m√™me cr√©neau horaire</li>
                    <li>V√©rifier que le message de conflit appara√Æt</li>
                    <li>Essayer de placer TD11 avec TP12 ‚Üí doit fonctionner</li>
                    <li>R√©p√©ter avec d'autres combinaisons de sous-groupes</li>
                </ol>
            </div>

            <div class="explanation">
                <strong>Statut de compilation :</strong>
                <span style="color: #16a34a; font-weight: bold;">‚úÖ Aucune erreur TypeScript</span>
                <br>
                <strong>Int√©gration :</strong>
                <span style="color: #16a34a; font-weight: bold;">‚úÖ R√®gle ajout√©e dans checkInstantConflict</span>
                <br>
                <strong>Compatibilit√© :</strong>
                <span style="color: #16a34a; font-weight: bold;">‚úÖ Compatible avec les r√®gles existantes</span>
            </div>
        </div>
    </div>
</body>
</html>